\subsection{Two electrons in two dimensions}

\subsubsection{Brute force sampling}

Standard error of the mean (SEM):
\begin{equation}
\text{SEM} = \frac{\sigma}{\sqrt{N}}
\end{equation}
where $N$ is the number of observations, in our case the number of Monte Carlo cycles.

The numbers show that the SEM is underestimating the deviations and that including the correlations in the random number generator increases the deviation, giving us $\sigma_b$.

\begin{table}[H]\caption{Comparing the results for analytical/numerical evaluation of the double derivative. Energy are in atomic units (a.u.) and CPU time is in units of seconds. Number of MC cycles are 2$^{21}$.}\label{tab:brute_force_no_interaction_2p}
\center
\begin{tabular}{l|l}
Analytical: &  Numerical:\\ \hline
\begin{tabular}{ccccc}
$\alpha$: & $\left< E_L \right>$: & SEM: & $\sigma_B$: & CPU time:\\ \hline
0.50 & 2.49402 & 0.00073 & 0.01022 & 5.57812\\
0.60 & 2.26441 & 0.00052 & 0.00690 & 5.76562\\
0.70 & 2.13118 & 0.00035 & 0.00448 & 5.92188\\
0.80 & 2.05016 & 0.00022 & 0.00263 & 5.67188\\
0.90 & 2.01015 & 0.00010 & 0.00116 & 5.96875\\
1.00 & 2.00000 & 0.00000 & 0.00000 & 5.62500\\
1.10 & 2.00871 & 0.00009 & 0.00102 & 6.20312\\
1.20 & 2.03402 & 0.00018 & 0.00175 & 6.34375\\
1.30 & 2.07259 & 0.00026 & 0.00244 & 5.95312\\
1.40 & 2.11041 & 0.00034 & 0.00311 & 6.15625\\ \hline
\end{tabular} & \begin{tabular}{ccccc}
$\alpha$: & $\left< E_L \right>$: & SEM: & $\sigma_B$: & CPU time:\\ \hline
0.50 & 2.49991 & 0.00073 & 0.01093 & 18.20310\\
0.60 & 2.26412 & 0.00053 & 0.00727 & 18.21880\\
0.70 & 2.13039 & 0.00036 & 0.00436 & 18.62500\\
0.80 & 2.04993 & 0.00022 & 0.00269 & 18.46880\\
0.90 & 2.01160 & 0.00010 & 0.00118 & 18.46880\\
1.00 & 2.00000 & 0.00000 & 0.00000 & 18.31250\\
1.10 & 2.00825 & 0.00009 & 0.00097 & 18.35940\\
1.20 & 2.03308 & 0.00018 & 0.00170 & 18.31250\\
1.30 & 2.06460 & 0.00026 & 0.00243 & 20.23440\\
1.40 & 2.11803 & 0.00033 & 0.00308 & 19.00000\\ \hline
\end{tabular}\\
Mean CPU time: 5.91875 & Mean CPU time:  18.62033\\
\end{tabular}
\end{table}

\subsubsection{Including importance sampling}

Figure \ref{fig:comparing_sampling} compare the expectation value of the energy and the acceptance rate of brute force sampling and importance sampling. It can be observed from the right part of the figure that the acceptance rate of both methods increase with decreasing step size, but one can also observe that the acceptance is lower for importance sampling than brute force sampling at large step sizes. These observations could indicate that a small step size would be ideal for both methods. 

\begin{figure}[H]
\center
\includegraphics[width=\linewidth]{../Results/comparing_sampling}\caption{•}\label{fig:comparing_sampling}
\end{figure}

From the left part of the figure it can be observed that one of the expectation values for the energies are lower than the ground state energy ($dl = 0.005$ with brute force sampling) when these calculations where done with $\alpha$ = 0.9. However, in Tab. \ref{tab:importance_no_interaction_2p} which compare the result of brute force sampling and importance sampling for different step sizes one can observe that the standard deviation from the blocking method is larger for the case of brute force sampling with a step size of 0.005. However,  the SEM does not indicate anything to be special about this result.

\begin{table}[H]\caption{Comparing the results for importance/brute force sampling. Energy are in atomic units (a.u.) and CPU time is in units of seconds. Here the parameter $\alpha$ is set to 0.9 and number of MC cycles are 2$^{21}$.}\label{tab:importance_no_interaction_2p}
\begin{tabular}{l|l|l} 
 & Brute force: &  Importance:\\ \hline
\begin{tabular}{c} 
$dl$:\\ \hline
1.000\\
0.500\\
0.100\\
0.050\\
0.010\\
0.005\\
0.001\\
\end{tabular} & \begin{tabular}{ccccc}
 $\left< E_L \right>$: & SEM: & $\sigma_B$: & Acc.: & $t_{CPU}$:\\ \hline
2.010 & 0.00010 & 0.00066 & 79.832& 6.625\\
2.011 & 0.00010 & 0.00112 & 89.794& 7.266\\
2.015 & 0.00011 & 0.00549 & 97.919& 7.078\\
2.007 & 0.00011 & 0.00946 & 99.001& 7.016\\
2.002 & 0.00007 & 0.01510 & 99.788& 6.953\\
1.942 & 0.00006 & 0.02140 & 99.916& 6.578\\
2.118 & 0.00002 & 0.00371 & 99.974& 6.531\\ \hline
\end{tabular} & \begin{tabular}{ccccc}
$\left< E_L \right>$: & SEM: & $\sigma_B$: & Acc.: & $t_{CPU}$:\\ \hline
2.011 & 0.00010 & 0.00022 & 71.078& 8.531\\
2.011 & 0.00010 & 0.00023 & 89.343& 8.672\\
2.011 & 0.00010 & 0.00047 & 99.049& 8.859\\
2.011 & 0.00010 & 0.00068 & 99.662& 8.188\\
2.007 & 0.00010 & 0.00136 & 99.968& 8.281\\
2.010 & 0.00010 & 0.00199 & 99.989& 8.547\\
2.007 & 0.00010 & 0.00410 & 99.999& 8.016\\ \hline
\end{tabular}\\
& Mean CPU time: 6.86384 & Mean CPU time: 8.44197 \\
\end{tabular}
\end{table}

I took a closer look at the actual local energies for the brute force sampling method. Figure \ref{fig:brute_force_small_steps} shows how the energy is not stable for steps sizes smaller than 0.01, so even though the step sizes 0.001 and 0.01 seems to give reasonable expectation values for the energy (see Tab. \ref{tab:importance_no_interaction_2p} and Fig. \ref{fig:comparing_sampling}), Fig. \ref{fig:brute_force_small_steps} seems to show that that is sort of a lucky shot. I also saw this by running the calculation with brute force sampling and the step size, $0.005$, with different seeds for the random number generator. The expectation energy for five different runs where $\left< E_L \right>$ =  1.91487, 2.03452, 1.90805, 1.88356 and 1.9284. From Fig. \ref{fig:brute_force_larger_steps} one can observe that even $dl=0.1$ seems to be too small since it also results in the local energy varying slowly and taking longer "trips" to higher energies and using many steps to get back down again, but for this step size the "trips" to higher energies are more frequent than for the smaller step sizes. I concluded that a step size of 0.5 is the best choice for the brute force sampling because it gives resonable changes of the local energy and an accpentance rate of $\sim$ 90 \%. 

\begin{figure}[H]
\begin{subfigure}{.5\textwidth}
\includegraphics[width=\linewidth]{../Results/brute_force_small_steps}\caption{}\label{fig:brute_force_small_steps}
\end{subfigure}
\begin{subfigure}{.5\textwidth}
\includegraphics[width=\linewidth]{../Results/brute_force_larger_steps}\caption{}\label{fig:brute_force_larger_steps}
\end{subfigure}
\caption{•}\label{fig:brute_force_step_sizes}
\end{figure}

%On the other hand, for the importance sampling, the investigation of the local energies did not give any clues to why the expecation energy is lower that the ground state energy for a step size of 0.5. Eventually I decided that the result itself indicate that 0.5 is a too large step size for importance sampling and taken together with a low acceptance rate at 0.5 ($\sim$ 82 \%) it is clear that a smaller step size is preferable. 
%
%At last, it is interesting to note that the CPU time of importance sampling is higher than the brute force sampling, so even though brute force sampling has a lower acceptance rate, at the ideal step size, than importance sampling the two methods seems to be somewhat comparable at least for the system I am investigating.
\begin{table}[H]\caption{Ground state energy of two electrons in harmonic oscillator trap. Number of MC cycles are $2^{23}$.}\label{tab:tab:ground_state_energy_different_omegas_no_interaction_2p}
\begin{tabular}{l|l|l} 
 & Brute force: &  Importance:\\ \hline
\begin{tabular}{c} 
$\omega$  \\ \hline
1.00  \\
0.50  \\
0.10  \\
0.05  \\
0.01  \\
\end{tabular} & \begin{tabular}{ccccc}
$\alpha$ & $\left< E_L \right>$ & $\overline{r}_{12} $ & $\left< T \right>$  & $\left< V_{ext}\right>$ \\ \hline
1 & 2.00 & 1.250 & 1.0008 & 0.9992\\
1 & 1.00 & 1.775 & 0.4971 & 0.5029\\
1 & 0.20 & 3.967 & 0.0996 & 0.1004\\ 
1 & 0.10 & 5.638 & 0.0497 & 0.0503\\ 
1 & 0.02 & 12.631 & 0.0099 & 0.0101\\  \hline
\end{tabular} & \begin{tabular}{ccccc}
$\alpha$ & $\left< E_L \right>$ & $\overline{r}_{12} $ & $\left< T \right>$  & $\left< V_{ext}\right>$ \\ \hline
1 & 2.00 & 1.254 & 0.9982 & 1.0018\\
1 & 1.00 & 1.781 & 0.4973 & 0.5027\\
1 & 0.20 & 4.046 & 0.0987 & 0.1013\\ 
1 & 0.10 & 5.534 & 0.0512 & 0.0488\\ 
1 & 0.02 & 12.488 & 0.0101 & 0.0099\\  \hline \hline
\end{tabular}\\
\end{tabular}
\end{table}

\begin{table}[H]\caption{Comparing the results for brute force sampling/importance sampling. Energy are in atomic units (a.u.) and CPU time is in units of seconds. Number of MC cycles are 2$^{21}$.}\label{tab:compare_importance_alphas_2p}
\center
\begin{tabular}{l|l|l}
 & Brute force: & Importance:\\ \hline
\begin{tabular}{c}
$\alpha$: \\ \hline
0.50 \\
0.60 \\
0.70 \\
0.80 \\
0.90\\
1.00 \\
1.10 \\
1.20 \\
1.30\\
1.40 \\ \hline
\end{tabular} & \begin{tabular}{cccc}
 $\left< E_L \right>$: & SEM: & $\sigma_B$: & CPU time:\\ \hline
2.49074 & 0.00072 & 0.01030 & 6.26562\\
2.27645 & 0.00053 & 0.00721 & 6.53125\\
2.12481 & 0.00036 & 0.00451 & 6.59375\\
2.04873 & 0.00022 & 0.00265 & 6.68750\\
2.01135 & 0.00010 & 0.00115 & 6.82812\\
2.00000 & 0.00000 & 0.00000 & 6.75000\\
2.00863 & 0.00009 & 0.00097 & 6.59375\\
2.03343 & 0.00018 & 0.00174 & 7.29688\\
2.07103 & 0.00026 & 0.00246 & 6.75000\\
2.11725 & 0.00033 & 0.00317 & 6.70312\\ \hline
\end{tabular} & \begin{tabular}{cccc}
$\left< E_L \right>$: & SEM: & $\sigma_B$: & CPU time:\\ \hline
2.52950 & 0.00075 & 0.01952 & 8.53125\\
2.26531 & 0.00052 & 0.01281 & 8.62500\\
2.12449 & 0.00036 & 0.00813 & 8.76562\\
2.04797 & 0.00022 & 0.00454 & 9.37500\\
2.01171 & 0.00010 & 0.00203 & 8.81250\\
2.00000 & 0.00000 & 0.00000 & 8.76562\\
2.00954 & 0.00009 & 0.00171 & 8.40625\\
2.03276 & 0.00018 & 0.00305 & 8.50000\\
2.07363 & 0.00026 & 0.00440 & 8.67188\\
2.10697 & 0.00034 & 0.00536 & 8.67188\\ \hline
\end{tabular}\\
& Mean CPU time:  6.7000 & Mean CPU time:  8.7125\\
\end{tabular}
\end{table}

\subsubsection{Including optimization}

Minimization rate of 0.5 seemed to be ideal. It resulted in the fewest steps until the parameter value stabilized both for guesses close to the optimal value and for guesses far away from the optimal value, but for the smallest trap frequencies I had to use $\gamma = $ 0.1 or 0.2. The parameters were optimized by trying out different first guesses for $\alpha$ and $\beta$ and tuning $\gamma$ so that the parameters stabilized during the first 200 iteretions. The optimal parameters were extracted from the mean of the last 50 iterations. An example run is shown in Fig. \ref{} for $\omega = 0.5$.

\subsubsection{Including interaction}

\begin{table}[H]\caption{Ground state energy of two interacting electrons in harmonic oscillator trap. Number of MC cycles are $2^{23}$}\label{tab:ground_state_energy_brute_force_interaction}
\center
\begin{tabular}{c|cccccrccc}
$\omega$ & $\alpha$ & $\beta$ & $\left< E_L \right>$ & SEM & $\sigma_B$ &  $\overline{r}_{12} \,\,\,$ & $\left< T \right>$  & $\left< V_{ext}\right>$ & $\left<V_{int} \right>$  \\ \hline
1.00000 & 0.98847 & 0.39965 & 3.0068 & 0.00001 & 0.00009 & 1.636 & 0.8944 & 1.2990 & 0.8135\\
0.50000 & 0.98061 & 0.31091 & 1.6674 & 0.00001 & 0.00010 & 2.481 & 0.4488 & 0.7051 & 0.5135\\
0.10000 & 0.94693 & 0.17764 & 0.4486 & 0.00001 & 0.00011 & 6.695 & 0.1003 & 0.1767 & 0.1716\\
0.05000 & 0.92747 & 0.13815 & 0.2609 & 0.00000 & 0.00011 & 10.389 & 0.0533 & 0.0997 & 0.1076\\
0.01000 & 0.88398 & 0.07287 & 0.0777 & 0.00000 & 0.00006 & 29.177 & 0.0129 & 0.0284 & 0.0364\\
\end{tabular}
\end{table}

\begin{table}[H]\caption{Ground state energy of two interacting electrons in harmonic oscillator trap. Number of MC cycles are $2^{22}$}\label{tab:ground_state_energy_importance_interaction}
\center
\begin{tabular}{c|ccccccccc}
$\omega$ & $\alpha$ & $\beta$ & $\left< E_L \right>$ & SEM & $\sigma_B$ & $|\bm{r}_1-\bm{r}_2|_{mean}$ & $\left< T \right>$  & $\left< V_{ext}\right>$ & $\left<V_{int} \right>$  \\ \hline
\end{tabular}
\end{table}

\subsection{One-body density}



\subsection{Extending to more particles}

\subsubsection{Six particles}

\subsubsection{Twelve particles}

